import{v as w,x as A,m as u,q as _,_ as y,o,c as a,y as V,z as I,a as t,F as b,s as S,t as c,A as $,B as P,r as m,b as f,d as T,C as k,D as R,E as U}from"./index-sroXMQlE.js";import{u as g}from"./userProductsStore-Ae74RjLh.js";import{l as E,c as D}from"./cartStore-CEk0Zvlf.js";import{s as B}from"./showErrorToast-Dxbxa5R0.js";import{C as x}from"./CartList-SKLujSl7.js";import"./showSuccessToast-Kwm6WSw7.js";import"./couponsStore-KIDG3-No.js";var H={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/create-vue-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:N,VITE_APP_PATH:M}=H,v=w("categoryStore",{state:()=>({categoryList:[]}),actions:{getCategory(){const e=`${N}/api/${M}/products/all`;A.get(e).then(n=>{const{products:l}=n.data,i=new Set(l.map(d=>d.category));this.categoryList=[...i]})}}}),O={data(){return{currentCategory:""}},watch:{currentCategory(){this.getProducts(this.currentCategory,1)}},computed:{...u(v,["categoryList"])},methods:{..._(g,["getProducts"])}},j=t("option",{value:""},"全部",-1),z=["value"];function F(e,n,l,i,d,h){return o(),a("div",null,[V(t("select",{"onUpdate:modelValue":n[0]||(n[0]=s=>d.currentCategory=s),class:"form-select form-select-sm"},[j,(o(!0),a(b,null,S(e.categoryList,s=>(o(),a("option",{key:s,value:s},c(s),9,z))),128))],512),[[I,d.currentCategory]])])}const X=y(O,[["render",F]]),q={computed:{...u(g,["pagination"])},methods:{..._(g,["getProducts"])}},G={class:"px-2"},Q={"aria-label":"Page navigation example"},J={class:"pagination"},K=t("span",{"aria-hidden":"true"},"«",-1),W=[K],Y={key:0,class:"page-link"},Z=["onClick"],tt=t("span",{"aria-hidden":"true"},"»",-1),et=[tt];function st(e,n,l,i,d,h){return o(),a("div",G,[t("nav",Q,[t("ul",J,[t("li",{class:$([{disabled:e.pagination.current_page===1},"page-item"])},[t("a",{onClick:n[0]||(n[0]=P(s=>e.getProducts(e.pagination.current_page-1),["prevent"])),class:"page-link",href:"#","aria-label":"Previous"},W)],2),(o(!0),a(b,null,S(e.pagination.total_pages,(s,p)=>(o(),a("li",{key:p,class:$([{active:s===e.pagination.current_page},"page-item"])},[s===e.pagination.current_page?(o(),a("span",Y,c(s),1)):(o(),a("a",{key:1,onClick:P(r=>e.getProducts(s),["prevent"]),class:"page-link",href:"#"},c(s),9,Z))],2))),128)),t("li",{class:$([{disabled:e.pagination.current_page===e.pagination.total_pages},"page-item"])},[t("a",{onClick:n[1]||(n[1]=P(s=>e.getProducts(e.pagination.current_page+1),["prevent"])),class:"page-link",href:"#","aria-label":"Next"},et)],2)])])])}const ot=y(q,[["render",st]]);var at={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/create-vue-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:nt,VITE_APP_PATH:rt}=at,it={components:{CategoryList:X,PaginationGroup:ot},data(){return{title:"商品列表",product:{}}},mounted(){this.getProducts(),this.getCategory()},computed:{...u(g,["productList"]),...u(v,["categoryList"]),...u(E,["loadingStatus"])},methods:{..._(g,["getProducts"]),..._(D,["addToCart"]),..._(v,["getCategory"]),async getProduct(e){const n=E();n.loadingStatus.getProduct=e;const l=`${nt}/api/${rt}/product/${e}`;this.$route.params.id=e;try{const i=await this.axios.get(l);this.product=i.data.product,n.loadingStatus.getProduct=""}catch(i){B(i.response.data.message)}finally{this.$router.push({name:"productInfo"})}}}},C=e=>(R("data-v-476fc7ea"),e=e(),U(),e),ct={class:"col-8 mt-4 mb-4",ref:"productList"},dt={class:"container d-flex justify-content-between"},lt={class:"p-2 mb-0"},pt={class:"container table-responsive"},ut={class:"table table-hover align-middle"},_t={class:"table-secondary"},gt={class:"align-middle fw-bold",style:{height:"48px"}},ht={scope:"col",style:{width:"17%"}},mt=C(()=>t("th",{scope:"col",style:{width:"30%"}},"商品名稱",-1)),ft=C(()=>t("th",{scope:"col",style:{width:"28%"}},"價格",-1)),yt=C(()=>t("th",{scope:"col",style:{width:"25%"}},null,-1)),$t=["src"],Pt={key:0,class:"fs-5 fw-bold mb-0"},vt={key:1},bt={class:"fs-6 fw-bold text-secondary"},St={class:"fs-5 fw-bold mb-0"},Ct={class:"d-flex flex-column gap-2"},Tt=["disabled","onClick"],kt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Et=["onClick"],Lt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function wt(e,n,l,i,d,h){const s=m("category-list"),p=m("pagination-group");return o(),a("div",ct,[t("div",dt,[t("h2",null,c(d.title),1),t("p",lt,c(`目前有 ${e.productList.length} 項商品`),1)]),t("div",pt,[t("table",ut,[t("thead",_t,[t("tr",gt,[t("th",ht,[f(s)]),mt,ft,yt])]),t("tbody",null,[(o(!0),a(b,null,S(e.productList,r=>(o(),a("tr",{key:r.title},[t("td",null,[t("img",{src:r.imageUrl,class:"rounded product-img"},null,8,$t)]),t("td",null,c(r.title),1),t("td",null,[r.origin_price===r.price?(o(),a("p",Pt,c(r.price)+"元 ",1)):(o(),a("div",vt,[t("del",bt,"原價"+c(r.origin_price)+"元",1),t("p",St,"現在只要"+c(r.price)+"元",1)]))]),t("td",null,[t("div",Ct,[t("button",{disabled:r.id===this.loadingStatus.getProduct,onClick:L=>h.getProduct(r.id),type:"button",class:"btn btn-outline-secondary",id:"modalBtn"},[T(" 查看更多 "),r.id===this.loadingStatus.getProduct?(o(),a("span",kt)):k("",!0)],8,Tt),t("button",{onClick:L=>e.addToCart(r.id),type:"button",class:"btn btn-outline-danger"},[T(" 加入購物車 "),r.id===this.loadingStatus.updateQty?(o(),a("span",Lt)):k("",!0)],8,Et)])])]))),128))])]),f(p)])],512)}const At=y(it,[["render",wt],["__scopeId","data-v-476fc7ea"]]),Vt={components:{ProductList:At,CartList:x}},It={class:"container"},Rt=t("h1",{class:"pt-5 text-center"},"商品列表",-1),Ut={class:"row py-2"};function Dt(e,n,l,i,d,h){const s=m("product-list"),p=m("cart-list");return o(),a("main",It,[Rt,t("div",Ut,[f(s),f(p)])])}const zt=y(Vt,[["render",Dt]]);export{zt as default};
