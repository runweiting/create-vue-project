import{m as r,q as u,S as v,_ as w,r as S,o,c as n,a as t,t as d,C as h,F as x,s as L,y as _,I as b,A as y,u as m,w as C,D as q,E as B}from"./index-CU5lGkkf.js";import{c as g,l as I}from"./cartStore-_9dm48cl.js";import{c as f}from"./couponsStore-lYH57srr.js";const V={data(){return{title:"購物車列表",couponCode:null}},mounted(){this.getCart()},computed:{...r(g,["cartList","cartTotal"]),...r(I,["loadingStatus"]),...r(f,["couponState"])},methods:{...u(g,["getCart","putCart","deleteCart","deleteCarts"]),...u(f,["postCoupon"]),applyCoupon(){this.postCoupon(this.couponCode).then(()=>{this.couponCode=""}).catch(e=>{v.fire({title:"套用優惠卷失敗",text:e.message||"發生未知錯誤",icon:"error",confirmButtonText:"確定"})})}}},l=e=>(q("data-v-dce6d164"),e=e(),B(),e),T={class:"col-4 mt-4 mb-4"},U={style:{position:"sticky",top:"0"}},$={class:"container d-flex justify-content-between"},D={class:"container table-responsive"},j={class:"table table-hover align-middle"},A=l(()=>t("thead",{class:"table-warning"},[t("tr",{class:"align-middle",style:{height:"48px"}},[t("th",{scope:"col",class:"fw-bold"},"品名"),t("th",{scope:"col",class:"fw-bold"},"數量/單位"),t("th",{scope:"col",class:"fw-bold text-end"},"單價"),t("th")])],-1)),E={key:0},F=l(()=>t("td",{colspan:"4"},[t("small",{class:"text-muted"}," 購物車目前沒有任何品項 ")],-1)),N=[F],Q={style:{width:"120px"}},z=["src"],M={style:{width:"120px"},class:"pe-0"},G={class:"d-flex justify-content-between align-items-center"},H={class:"input-group input-group-sm",style:{width:"80px"}},J=["disable","onClick","onUpdate:modelValue"],K={class:"input-group-text"},O={class:"m-0 border-0 d-flex",style:{width:"40px"}},P=["onClick"],R=l(()=>t("i",{class:"bi bi-trash3"},null,-1)),W=[R],X={style:{width:"110px"},class:"text-end"},Y={class:"fs-6 mb-0"},Z={style:{width:"30px"},class:"text-end p-0"},tt=["onClick"],et={class:"text-muted"},st=l(()=>t("td",null,"總計",-1)),ot={key:0,class:"text-end"},nt={key:1,class:"text-end"},lt=l(()=>t("td",null,null,-1)),at={colspan:"4"},dt={class:"input-group"},ct=["disabled","placeholder"],it={colspan:"4"},rt=l(()=>t("button",{type:"button",class:"btn btn-outline-primary w-100",style:{height:"38px"}}," 前往商品列表 ",-1)),pt=l(()=>t("button",{type:"button",class:"btn btn-outline-success w-100",style:{height:"38px"}}," 前往購物車 ",-1));function ut(e,a,ht,_t,c,k){const p=S("router-link");return o(),n("div",T,[t("div",U,[t("div",$,[t("h2",null,d(c.title),1),e.cartList.length!==0?(o(),n("button",{key:0,onClick:a[0]||(a[0]=(...s)=>e.deleteCarts&&e.deleteCarts(...s)),type:"button",class:"btn btn-outline-danger btn-sm",style:{height:"38px"}}," 清空購物車 ")):h("",!0)]),t("div",D,[t("table",j,[A,t("tbody",null,[e.cartList.length===0?(o(),n("tr",E,N)):(o(!0),n(x,{key:1},L(e.cartList,s=>(o(),n("tr",{key:s.id},[t("td",Q,[t("img",{src:s.product.imageUrl,class:"rounded cart-img"},null,8,z)]),t("td",M,[t("div",G,[t("div",H,[_(t("input",{disable:s.id===e.loadingStatus.updateQty,onClick:i=>e.putCart(s),"onUpdate:modelValue":i=>s.qty=i,type:"number",min:"1",class:"form-control"},null,8,J),[[b,s.qty]]),t("span",K,d(s.product.unit),1)]),t("div",O,[t("button",{class:y([{"d-none":s.qty>1},"btn btn-outline-danger"]),onClick:i=>e.deleteCart(s.id),type:"button",style:{scale:"60%"}},W,10,P),s.id===e.loadingStatus.updateQty?(o(),n("span",{key:0,class:y([{"d-none":s.qty===1},"spinner-border spinner-border-sm ms-2"]),role:"status","aria-hidden":"true"},null,2)):h("",!0)])])]),t("td",X,[t("p",Y,d(s.product.price)+"元",1)]),t("td",Z,[t("button",{onClick:i=>e.deleteCart(s.id),type:"button",class:"btn btn-outline-danger btn-sm py-0",style:{scale:"80%"}}," x ",8,tt)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",null,[t("small",et,d(`總共 ${e.cartList.length} 項`),1)]),st,e.couponState.success?(o(),n("td",nt,d(e.couponState.data.final_total)+"元",1)):(o(),n("td",ot,d(e.cartTotal)+"元",1)),lt]),t("tr",null,[t("td",at,[t("div",dt,[_(t("input",{disabled:e.couponState.success,"onUpdate:modelValue":a[1]||(a[1]=s=>c.couponCode=s),type:"text",class:"form-control",placeholder:e.couponState.success?e.couponState.message:"請輸入優惠碼","aria-label":"coupon_code","aria-describedby":"coupon_code"},null,8,ct),[[b,c.couponCode]]),t("button",{onClick:a[2]||(a[2]=s=>k.applyCoupon(c.couponCode)),class:"btn btn-secondary",type:"button",id:"coupon_code"},"套用優惠卷")])])]),t("tr",null,[t("td",it,[e.cartList.length===0?(o(),m(p,{key:0,to:{name:"products"}},{default:C(()=>[rt]),_:1})):(o(),m(p,{key:1,to:{name:"cart"}},{default:C(()=>[pt]),_:1}))])])])])])])])}const Ct=w(V,[["render",ut],["__scopeId","data-v-dce6d164"]]);export{Ct as C};
