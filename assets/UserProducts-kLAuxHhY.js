import{v as B,x as N,m as _,q as p,_ as f,o,c as a,y as V,z as I,a as t,F as P,s as C,t as c,A as m,B as b,r as y,b as $,d as S,C as w,D,E as T}from"./index-RjNXQEZd.js";import{p as g}from"./productsStore-JtYYokuN.js";import{l as L,c as z}from"./cartStore-wo3WMO7E.js";import{p as x}from"./productInfoStore-0ToweWrD.js";import{C as A}from"./CartList-wNXxM6f6.js";const E="https://vue3-course-api.hexschool.io/v2",F="runweiting",v=B("categoryStore",{state:()=>({categoryList:[]}),actions:{getCategory(){const e=`${E}/api/${F}/products/all`;N.get(e).then(n=>{const{products:d}=n.data,l=new Set(d.map(i=>i.category));this.categoryList=[...l]})}}}),M={data(){return{currentCategory:""}},watch:{currentCategory(){this.getProducts(this.currentCategory,1)}},computed:{..._(v,["categoryList"])},methods:{...p(g,["getProducts"])}},j=t("option",{value:""},"全部",-1),q=["value"];function G(e,n,d,l,i,h){return o(),a("div",null,[V(t("select",{"onUpdate:modelValue":n[0]||(n[0]=s=>i.currentCategory=s),class:"form-select form-select-sm"},[j,(o(!0),a(P,null,C(e.categoryList,s=>(o(),a("option",{key:s,value:s},c(s),9,q))),128))],512),[[I,i.currentCategory]])])}const Q=f(M,[["render",G]]),H={computed:{..._(g,["pagination"])},methods:{...p(g,["getProducts"])}},J={class:"px-2"},K={"aria-label":"Page navigation example"},O={class:"pagination"},R=t("span",{"aria-hidden":"true"},"«",-1),W=[R],X={key:0,class:"page-link"},Y=["onClick"],Z=t("span",{"aria-hidden":"true"},"»",-1),tt=[Z];function et(e,n,d,l,i,h){return o(),a("div",J,[t("nav",K,[t("ul",O,[t("li",{class:m([{disabled:e.pagination.current_page===1},"page-item"])},[t("a",{onClick:n[0]||(n[0]=b(s=>e.getProducts(e.pagination.current_page-1),["prevent"])),class:"page-link",href:"#","aria-label":"Previous"},W)],2),(o(!0),a(P,null,C(e.pagination.total_pages,(s,u)=>(o(),a("li",{key:u,class:m([{active:s===e.pagination.current_page},"page-item"])},[s===e.pagination.current_page?(o(),a("span",X,c(s),1)):(o(),a("a",{key:1,onClick:b(r=>e.getProducts(s),["prevent"]),class:"page-link",href:"#"},c(s),9,Y))],2))),128)),t("li",{class:m([{disabled:e.pagination.current_page===e.pagination.total_pages},"page-item"])},[t("a",{onClick:n[1]||(n[1]=b(s=>e.getProducts(e.pagination.current_page+1),["prevent"])),class:"page-link",href:"#","aria-label":"Next"},tt)],2)])])])}const st=f(H,[["render",et]]),ot={components:{CategoryList:Q,PaginationGroup:st},data(){return{apiUrl:"https://vue3-course-api.hexschool.io/v2",apiPath:"runweiting",title:"商品列表",product:{}}},mounted(){this.getProducts(),this.getCategory()},computed:{..._(g,["productList"]),..._(v,["categoryList"]),..._(L,["loadingStatus"])},methods:{...p(g,["getProducts"]),...p(z,["addToCart"]),...p(v,["getCategory"]),...p(x,["setSelectedProduct"]),async getProduct(e){const n=L();n.loadingStatus.getProduct=e;const d=`${this.apiUrl}/api/${this.apiPath}/product/${e}`;this.$route.params.id=e;try{const l=await this.axios.get(d);this.product=l.data.product,x().setSelectedProduct(this.product),n.loadingStatus.getProduct=""}finally{this.$router.push({name:"productInfo"})}}}},k=e=>(D("data-v-fc7be5c8"),e=e(),T(),e),at={class:"col-8 mt-4 mb-4",ref:"productList"},nt={class:"container d-flex justify-content-between"},rt={class:"p-2 mb-0"},it={class:"container table-responsive"},ct={class:"table table-hover align-middle"},dt={class:"table-secondary"},lt={class:"align-middle",style:{height:"48px"}},pt={scope:"col",style:{width:"17%"}},ut=k(()=>t("th",{scope:"col",class:"fw-bold",style:{width:"30%"}},"商品名稱",-1)),_t=k(()=>t("th",{scope:"col",class:"fw-bold",style:{width:"28%"}},"價格",-1)),gt=k(()=>t("th",{scope:"col",style:{width:"25%"}},null,-1)),ht=["src"],yt={key:0,class:"fs-5 fw-bold mb-0"},$t={key:1},ft={class:"fs-6 fw-bold text-secondary"},mt={class:"fs-5 fw-bold mb-0"},bt={class:"d-flex flex-column gap-2"},vt=["disabled","onClick"],Pt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ct=["onClick"],kt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function St(e,n,d,l,i,h){const s=y("category-list"),u=y("pagination-group");return o(),a("div",at,[t("div",nt,[t("h2",null,c(i.title),1),t("p",rt,c(`目前有 ${e.productList.length} 項商品`),1)]),t("div",it,[t("table",ct,[t("thead",dt,[t("tr",lt,[t("th",pt,[$(s)]),ut,_t,gt])]),t("tbody",null,[(o(!0),a(P,null,C(e.productList,r=>(o(),a("tr",{key:r.title},[t("td",null,[t("img",{src:r.imageUrl,class:"rounded product-img"},null,8,ht)]),t("td",null,c(r.title),1),t("td",null,[r.origin_price===r.price?(o(),a("p",yt,c(r.price)+"元 ",1)):(o(),a("div",$t,[t("del",ft,"原價"+c(r.origin_price)+"元",1),t("p",mt,"現在只要"+c(r.price)+"元",1)]))]),t("td",null,[t("div",bt,[t("button",{disabled:r.id===this.loadingStatus.getProduct,onClick:U=>h.getProduct(r.id),type:"button",class:"btn btn-outline-secondary",id:"modalBtn"},[S(" 查看更多 "),r.id===this.loadingStatus.getProduct?(o(),a("span",Pt)):w("",!0)],8,vt),t("button",{onClick:U=>e.addToCart(r.id),type:"button",class:"btn btn-outline-danger"},[S(" 加入購物車 "),r.id===this.loadingStatus.updateQty?(o(),a("span",kt)):w("",!0)],8,Ct)])])]))),128))])]),$(u)])],512)}const wt=f(ot,[["render",St],["__scopeId","data-v-fc7be5c8"]]),Lt={components:{ProductList:wt,CartList:A}},xt={class:"container"},Ut=t("h1",{class:"pt-5 text-center"},"商品列表",-1),Bt={class:"row py-2"};function Nt(e,n,d,l,i,h){const s=y("product-list"),u=y("cart-list");return o(),a("main",xt,[Ut,t("div",Bt,[$(s),$(u)])])}const At=f(Lt,[["render",Nt]]);export{At as default};
