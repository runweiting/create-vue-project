import{_ as p,I as l,S as s,r as f,o as h,c as _,a as e,x as d,H as u,b as x,w as g,d as w}from"./index-xVhxExL5.js";const k={data(){return{apiUrl:"https://vue3-course-api.hexschool.io/v2",apiPath:"runweiting",user:{username:"",password:""}}},created(){const o=document.cookie.replace(/(?:(?:^|.*;\s*)myToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");o&&(this.axios.defaults.headers.common.Authorization=o)},methods:{login(){if(l()){s.fire({title:"已成功登入，不需重複登入",icon:"success",confirmButtonText:"OK"}),this.goToWeek4Admin();return}const o=`${this.apiUrl}/admin/signin`;this.axios.post(o,this.user).then(t=>{const{expired:r,token:a}=t.data;document.cookie=`myToken=${a}; expires=${new Date(r)}`,s.fire({title:"您已成功登入",icon:"success",confirmButtonText:"OK"}).then(()=>{this.goToWeek4Admin()}),this.user={}}).catch(t=>{t.response&&t.response.status===400?s.fire({title:"登入帳號或密碼錯誤",text:"請輸入正確的帳號和密碼",icon:"error",confirmButtonText:"OK"}):(this.user.username===""||this.user.password==="")&&s.fire({title:"請輸入登入信箱和密碼",icon:"error",confirmButtonText:"OK"})})},goToWeek4Admin(){l()?(s.fire({title:"這是後台商品頁面",icon:"success",confirmButtonText:"OK"}),this.$router.push({name:"admin"})):(s.fire({title:"請先登入",icon:"error",confirmButtonText:"OK"}),this.$router.push({name:"login"}))}}},T={class:"container"},b=e("h1",{class:"pt-5 text-center"},"登入後台",-1),v={class:"row py-5 flex-column align-items-center"},y=e("div",{class:"col-md-6 text-center mb-3"},[e("h3",null,"請先登入")],-1),B={class:"col-md-6"},K={class:"form-floating mb-3"},O=e("label",{for:"floatingInput"},"Email address",-1),$={class:"form-floating mb-3"},A=e("label",{for:"floatingPassword"},"Password",-1),P={class:"d-flex gap-2"},U=e("p",{class:"text-secondary text-center pt-5"},"© create-vue-project",-1);function V(o,t,r,a,i,c){const m=f("router-link");return h(),_("main",T,[b,e("div",v,[y,e("div",B,[e("form",null,[e("div",K,[d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>i.user.username=n),type:"email",class:"form-control",id:"floatingInput",placeholder:"name@example.com",autocomplete:"email"},null,512),[[u,i.user.username]]),O]),e("div",$,[d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>i.user.password=n),type:"password",class:"form-control",id:"floatingPassword",placeholder:"Password",autocomplete:"current-password"},null,512),[[u,i.user.password]]),A]),e("div",P,[e("button",{onClick:t[2]||(t[2]=(...n)=>c.login&&c.login(...n)),type:"button",class:"btn btn-primary w-50"}," 登入 "),x(m,{to:"/",class:"btn btn-primary w-50"},{default:g(()=>[w("回到首頁")]),_:1})])]),U])])])}const C=p(k,[["render",V]]);export{C as default};
